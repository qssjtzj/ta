<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<title></title>
<meta name="keywords" content="，，">
<meta name="description" content="" />
<meta name="author" content="Design:ZhangXi; Web Layout:HXH;" />
<link type="image/x-icon" href="../favicon.ico" rel="icon"/>
<link type="image/x-icon" href="../favicon.ico" rel="shortcut icon" />
<link type="text/css" rel="stylesheet" href="../css/index.css" />
<link type="text/css" rel="stylesheet" href="../css/jquery-ui.css" />

</head>

<body>
<!--顶部导航-->
<div id="header" ></div>
<!--div class="warp"><a href='../index.html' class='top_nav_home'>HOME</a></div-->

	<!--内容部分-->
	<div class="warp">
		<div class="content">
        	<div class="center_left">
            	<iframe src="left.html" width="250" height="880" scrolling="no" allowtransparency="true" frameborder="0" ></iframe>
             	
            </div>
        	<div class="center_right ">
            	<div class="right center_user_bg">
    
                    <div class="userinfo_update m20" >
                        <h2>Gifts Record</h2>

                        <div class="group_update bc  ">
							<div id="gift_active_no" class="modify_cont description m20" >
								<span style="margin-right:25px">昵称： <font style="color:#ed6800"><span id="account_name" ></span></font></span>
								<span style="margin-right:28px">鲜花：<span id="account_flower" >0</span></span>粉丝：<span id="account_followme" >0</span>
							</div>
                        	<ul class="checkNav tab">
                                <li><a href="?atype=1" id="tab_gift_1" class="tab_border0">Gifts History</a></li>
                                <li><a href="?atype=2" id="tab_gift_2" class="tab_border0">Gifts Sending</a></li>
                            </ul>
                            <div class="h3_line"></div>
                            
                            <!-- start-->
                            <form class="checkFrm mt30">
                                <div class=" color333 line40 fts12">        	
                                	<label for="d1">From </label>
                                    <input type="text" readonly="readonly" class="input_border" name="start" id="d1" />
                                    <img align="absmiddle" src="../imgs/icon_date.png" id="d1img" class="icon_group_date"/>
                                    <label for="d2">To</label>
                                    <input type="text" readonly="readonly" class="input_border" name="end" id="d2" />          
                                    <img align="absmiddle" src="../imgs/icon_date.png" id="d2img" class="icon_group_date"/> 
                                    <!-- 
                                    <label for="d2">物品：</label>
                                    <input type="text" class="input_border" style=" width:80px;" name="goods" id="goods" />
                                     -->  
                                    <label for="d2">Group</label>
                                    <input type="text" class="input_border" style=" width:80px;" name="group" id="group" />          	
                                    <a onclick="rcopen.api.searchRecord('receive')" id="btnSearchRecord" class="btnSmall btn_check" href="javascript:;"><span>Search</span></a>
                                </div>
                                
                            </form>
                            <div class="dash_line"></div>
                            <div class="checkList">
                            <div style="display:none;" id="recordListBox1">  <span class="checkListTitle line40">Search Result: <st id="searchrs" name="searchrs" value=""></st></span>
                                <table width="100%" border="1" class="checkData">
                                    <thead>
                                      <tr>
                                        <th width="20%">Gifts By</th>
                                        <th width="20%">Gifts</th>
                                        <th width="20%">Quantity</th>
                                        <th width="20%">Cost</th>
                                        <th width="15%">Group</th>
                                        <th width="15%">Time</th>
                                      </tr>
                                    </thead>
                                    <tbody id="recordList1">
                                    </tbody>
                                </table>
                                <div id="recordPages1" class="recordPages"></div>
                            </div>
                            
                            <div style="display:none;" id="recordListBox2"> <span class="checkListTitle line40">Search Result</span>
                              <table width="100%" border="1" class="checkData">
                                <thead>
                                  <tr>
                                   <th width="20%">Recipient</th>
                                    <th width="20%">Gifts</th>
                                    <th width="20%">Quantity</th>
                                    <th width="20%">Cost</th>
                                    <th width="15%">Group</th>
                                    <th width="15%">Time</th>
                                  </tr>
                                </thead>
                                <tbody id="recordList2">
                                </tbody>
                              </table>
                              <div id="recordPages2" class="recordPages"></div>
                            
                            </div>
                            <p style="display:none" class="noRecord pt20" id="noRecordTip">No Records Found within this period of time!</p>
                        </div>
                        </div>
                        
                    </div>
                   
                </div>
                
                
            </div>
        </div>
	</div>

<script type="text/javascript" src="../js/open.rc.js"></script> 
<script type="text/javascript" src="../js/open.common.js"></script> 
<script type="text/javascript" src="../js/country.js"></script>
<script type="text/javascript" src="../js/open.center.js"></script>
<script src="../js/pay/main.js?v=20131111" type="text/javascript"></script>
<script src="../js/My97DatePicker/WdatePicker.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript"> 
$(document).ready(function() {
	
	rcopen.api.getFlowerInfo();
	
	var atype = opencyou.utils.getParamFromUrl("atype");
	if(atype=='' || atype=='undefine'){
		atype=1;
	}
	$(".tab li a").removeClass("current");
	$("#tab_gift_"+atype).addClass("current");
	
});


$(function() {

    //============================== WdatePicker ==============================
    var maxDate = new Date();
    var strMaxDate = maxDate.getFullYear() + '-' + (maxDate.getMonth() + 1) + '-' + maxDate.getDate();
    
	//最早时间6个月前
    var minDate = new Date(maxDate.getTime() - 1000 * 60 * 60 * 24 * 30 * 6);
    var strMinDate = minDate.getFullYear() + '-' + (minDate.getMonth() + 1) + '-' + minDate.getDate();
    
    function d2picked() {
        var d1 = $('#d1');
        var d2 = $(this);
        if (new Date(d2.val()) < new Date(d1.val())) {
            var d1txt = d1.val();
            var d2txt = d2.val();
            d1.val(d2txt);
            d2.val(d1txt);
        }
    }
    
    function d1fun() {
        WdatePicker({
            el: 'd1',
            minDate: strMinDate,
            maxDate: strMaxDate
        });
    }
    
    function problemTime() {
        WdatePicker({
            el: 'problemTime'
        });
    }
    
    function d2fun() {
        if ($('#d1').val().length == 0) {
            WdatePicker({
                el: 'd1',
                minDate: strMinDate,
                maxDate: strMaxDate
            });
        } else {
            var selectedDate1 = new Date($('#d1').val());
            var strMinDate2 = selectedDate1.getFullYear() + '-' + (selectedDate1.getMonth() + 1) + '-01';
			//截止时间最大为当前时间
            var strMaxDate2 = maxDate;//selectedDate1.getFullYear() + '-' + (selectedDate1.getMonth() + 1) + '-%ld';
            WdatePicker({
                el: 'd2',
                minDate: strMinDate2,
                maxDate: selectedDate1.getMonth() < new Date().getMonth() ? strMaxDate2 : strMaxDate,
                onpicked: d2picked
            });
        }
    }
    
    var context = $('form.checkFrm');
    var date1 = $('#d1', context).focus(d1fun);
    var date2 = $('#d2', context).focus(d2fun);
    $('#d1img', context).click(d1fun);
    $('#d2img', context).click(d2fun);
    $('#problemTime').click(problemTime);
    
    //============================== Record ==============================
    $('.checkNav li', $('#content')).click(function() {
        $('.checkNav li', $('#content')).removeClass('current');
        $(this).addClass('current');
        $('#recordListBox1,#recordListBox2,#noRecordTip').hide();
        date1.add(date2).val('');
        if ($(this).index() == 0) {
            $('#btnSearchRecord').attr('onclick', "searchRecord('pay')");
        } else {
            $('#btnSearchRecord').attr('onclick', "searchRecord('exchange')");
        }
        return false;
    });
});

</script> 

<script type="text/javascript">
		$(function() {
			window.recordPageObj1 = new clsSimpleTurnPage();
			recordPageObj1.breakSize = 9;
			recordPageObj1.pageSize = 12;
			recordPageObj1.beforeGo = function(page) {
			//	console.log(page);
			};
			recordPageObj1.complete = function(page, pageData) {
				var html = '';
				for (var i = 0; i < pageData.length-1; i++) {
					var stateCls = '';
					if (pageData[i].stateCode == -1)
						stateCls = 'red';
					if (pageData[i].stateCode == 2)
						stateCls = 'green';
					var stateText = '<font color="' + stateCls + '">' + pageData[i].state + '</font>';
					var cls = i % 2 == 1 ? 'even' : '';
					html += '<tr class="' + cls + '">';
					html += '<td>' + pageData[i].uid + '</td>';
					html += '<td>' + pageData[i].giftid + '</td>';
					html += '<td>' + pageData[i].giftnum + '</td>';
					html += '<td>' + pageData[i].giftcost + '</td>';
					html += '<td>' + pageData[i].channelid + '</td>';
					html += '<td>' + pageData[i].time + '</td>';
					html += '</tr>';
				}
				$('#recordList1').html(html);
				
				var rs = '从'+$('#d1').val()+'—'+$('#d2').val()+' 共计'+pageData[pageData.length-1].profit+'元';
				$('#searchrs').html(rs);
//				$(this.pageDiv).find('.pageCount').text(page + '页/' + this.totalPage + '页');
			};
			//recordPageObj1.api = '/view/record_api.php?page_size=12&amp;start=2012-12-20&amp;end=2013-02-05&amp;type=pay';
			//recordPageObj1.init(26, 'recordPages1', 'recordPageObj1');
		});
</script>
<script type="text/javascript">
		$(function() {
			window.recordPageObj2 = new clsSimpleTurnPage();
			recordPageObj2.breakSize = 9;
			recordPageObj2.pageSize = 12;
			recordPageObj2.beforeGo = function(page) {
				//console.log(page);
			};
			recordPageObj2.complete = function(page, pageData) {
				var html = '';
				for (var i = 0; i < pageData.length; i++) {
					var stateCls = '';
					if (pageData[i].stateCode == -1)
						stateCls = 'red';
					if (pageData[i].stateCode == 2)
						stateCls = 'green';
					var stateText = '<font color="' + stateCls + '">' + pageData[i].state + '</font>';
					var cls = i % 2 == 1 ? 'even' : '';
					html += '<tr class="' + cls + '">';
					html += '<td>' + pageData[i].uid + '</td>';
					html += '<td>' + pageData[i].giftid + '</td>';
					html += '<td>' + pageData[i].giftnum + '</td>';
					html += '<td>' + pageData[i].giftcost + '</td>';
					html += '<td>' + pageData[i].channelid + '</td>';
					html += '<td>' + pageData[i].time + '</td>';
					html += '</tr>';
				}
				$('#recordList2').html(html);
//				$(this.pageDiv).find('.pageCount').text(page + '页/' + this.totalPage + '页');
			};
		});
</script>

</body>
</html>
